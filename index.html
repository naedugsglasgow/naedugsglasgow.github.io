<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Nae Dugs Glasgow - Dog Policy Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:50px; bottom:0; width:100%; }
  #filterButtons {
    position: absolute;
    top: 5px; left: 10px;
    z-index: 1;
    background: white;
    padding: 5px 10px;
    border-radius: 4px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.3);
  }
  #filterButtons button {
    margin-right: 5px;
    cursor: pointer;
  }
</style>
</head>
<body>

<div id="filterButtons">
  <button onclick="filterMarkers('all')">All</button>
  <button onclick="filterMarkers('green')">Completely dog-free</button>
  <button onclick="filterMarkers('orange')">Dog-free section</button>
  <button onclick="filterMarkers('red')">Fully dog friendly</button>
</div>

<div id="map"></div>

<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoibmFlZHVnc2dsYXNnb3ciLCJhIjoiY21lM2F4ZXJqMDVqcjJpczc4OXlhd2NjaiJ9.x89RmWhqtd4qR_GKMTYccA';
  const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v12',
    center: [-4.2518, 55.8642], // Glasgow centre
    zoom: 14
  });

  const markers = {
    green: [],
    orange: [],
    red: []
  };

  function addMarker(lng, lat, color, popupHTML) {
    const marker = new mapboxgl.Marker({ color: color })
      .setLngLat([lng, lat])
      .setPopup(new mapboxgl.Popup().setHTML(popupHTML))
      .addTo(map);

    markers[color].push(marker);
  }

  // Example venue: Ottoman Coffee House (completely dog-free)
  addMarker(-4.2752199, 55.8651038, 'green', "<b>Ottoman Coffee House</b><br>Completely dog-free venue");

  function filterMarkers(color) {
    if (color === 'all') {
      Object.values(markers).flat().forEach(marker => marker.addTo(map));
    } else {
      Object.entries(markers).forEach(([key, arr]) => {
        if (key === color) {
          arr.forEach(marker => marker.addTo(map));
        } else {
          arr.forEach(marker => marker.remove());
        }
      });
    }
  }
</script>

</body>
</html>

const popupContent = `
  <div>
    <h3>Ottoman Coffee House</h3>
    <p><a href="https://www.ottomancoffeehouse.co.uk/" target="_blank" rel="noopener noreferrer">Visit website</a></p>
    <p><strong>Dog Policy:</strong> Assistance dogs only, no pets</p>
  </div>
`;

addMarker(-4.2752199, 55.8651038, 'green', popupContent);
